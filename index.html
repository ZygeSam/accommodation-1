<!DOCTYPE html>
<html>

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <title>Accommodation Service Provider</title>

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
  <link rel="stylesheet" href="css/magnific-popup.css">
  <link rel="stylesheet" href="css/jquery-ui.css">
  <link rel="stylesheet" href="css/owl.carousel.min.css">
  <link rel="stylesheet" href="css/owl.theme.default.min.css">
  <link rel="stylesheet" href="css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="css/mediaelementplayer.css">
  <link rel="stylesheet" href="css/animate.css">
  <link rel="stylesheet" href="css/fl-bigmug-line.css">
    
  
    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/style2.css">

  <!-- fonts style -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:400,700|Raleway:400,700&display=swap" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <link href="css/style2.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
  <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />
  <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.js"></script>
  <link
    rel="stylesheet"
    href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.css"
    type="text/css"
  />
  <link rel="stylesheet" href="css/main.css">
  <script src="./js/jquery.min.js"></script>
<style>
body { margin: 0; padding: 0; }

#fly {
display: block;
position: relative;
margin: 0px auto;
width: 50%;
height: 40px;
padding: 10px;
border: none;
border-radius: 3px;
font-size: 12px;
text-align: center;
color: #fff;
background: #ee8a65;
}
#map {
  height: 450px;
  /* background-color:blue; */
  width:100%;
  stroke-width: 80%;
  }
  #info {
    display: table;
    position: relative;
    margin: 0px auto;
    word-wrap: anywhere;
    white-space: pre-wrap;
    padding: 10px;
    border: none;
    border-radius: 3px;
    font-size: 12px;
    text-align: center;
    color: #222;
    background: #fff;
    }

</style>
</head>
<body>
  <div class="hero_area">
    <!-- header section strats -->
    <header class="header_section">
      <div class="container-fluid">
        <nav class="navbar navbar-expand-lg custom_nav-container">
          <a class="navbar-brand" href="index.html">
            Accommodation Service Provider
          </a>
          <div class="navbar-collapse" id="">
            <ul class="navbar-nav justify-content-between ">
              <div class="User_option">
                <li class="">
                  <a class="mr-4" href="login.html">
                    Login
                  </a>
                  <a class="" href="signup.html">
                    Sign up
                  </a>
                </li>
              </div>
            </ul>

            <div class="custom_menu-btn">
              <button onclick="openNav()">
                <span class="s-1">

                </span>
                <span class="s-2">

                </span>
                <span class="s-3">

                </span>
              </button>
            </div>
            <div id="myNav" class="overlay">
              <div class="overlay-content">
                <a href="index.html">HOME</a>
                <a href="about.html">ABOUT</a>
                <a href="house.html">HOUSE</a>
                <a href="price.html">PRICING</a>
                <a href="contact.html">CONTACT US</a>
              </div>
            </div>
          </div>
        </nav>
      </div>
    </header>
    <!-- end header section -->
     <!-- slider section -->
    <section class="slider_section ">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-4 offset-md-1">
            <div class="detail-box">
              <h1>
                <span> Modern</span> <br>
                Apartment <br>
                House
              </h1>
              <p>
                It is a long established fact that a reader will be distracted by the readable content of
              </p>
              <div class="btn-box">
                <a href="" class="">
                  Read More
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
  <div class="container bg-white border border-4-primary mt-4 px-5">
    <div class="row">
        <div class="col-12">
            <p class="lead text-center mt-5 ">Select a map</p>
        </div>
       
        <div class="col-md-9  main_map">
            <div id="map"></div>
            <pre id="info"></pre>
        </div>
        <div class="col-md-3 maps">
            <div class="cities">
                <div class="image_maps" id="map1">
                    <img src="images/map1.jpeg" alt="England">
                    <p class="m-2 text-center">AB10 1XG</p>
                </div>
                <div class="image_maps" id="map2">
                    <img src="images/map2.jpeg" alt="Scotland">
                    <p class="m-2 text-center">AB10 6RN</p>
                </div>
                <div class="image_maps" id="map3">
                    <img src="images/map3.jpeg" alt="Ireland">
                    <p class="m-2 text-center">AB10 7JB</p>
                </div>
                <div class="image_maps" id="map4">
                    <img src="images/map4.jpeg" alt="Wales">
                    <p class="m-2 text-center">AB11 5QN</p>
                </div>
                <div class="image_maps" id="map5">
                    <img src="images/map4.jpeg" alt="Wales">
                    <p class="m-2 text-center">AB11 6UL</p>
                </div>
                <div class="image_maps" id="map6">
                    <img src="images/map4.jpeg" alt="Wales">
                    <p class="m-2 text-center">AB11 8RQ</p>
            </div>
            </div>
            <form action="" id="myForm">
                <label for="budget" id="budget_label"> What is your budget(pounds): </label>
                <input type="range"  class ="input" name="budget" id="budget" min="100" max="100000">

                <label for="valuation"style="margin-right:5px;">Choose valuation type</label>
                <select class="form-control input" id="valuation_type" name="valuation_type">
                  <option value="Rent">Rent</option>
                  <option value= "Sale">Sale</option>
                  <option value="shortlet">Shortlet</option>
                  <option>All</option>
                </select>

                <label for="landmark"style="margin-right:5px;">Choose landmark</label>
                <select class="form-control input" id="landmark" name="landmark">
                  <option value="Nightclub">Nightclub</option>
                  <option value="Parks">Parks</option>
                  <option  value="Beach">Beach</option>
                  <option value="Pol">Pol</option>
                </select>

                <label for="mile" style="margin-right:5px;" id="mile_label">Choose mile: </label>
                <input type="range"  class ="input" name="mile" id="mile"  min="10" max="100">

                <label for="building"style="margin-right:5px;">Choose building type</label>
                <select class="form-control input" id="building" name="building">
                  <option id="farmhouse">Farm house</option>
                  <option id="condo">Condo</option>
                  <option id="beachhouse">Beach house</option>
                  <option id="duplex">Duplex</option>
                </select>

                <label for="number_of_bedrooms"style="margin-right:5px;" id="bedroom_label">Choose number_of_bedrooms: </label>
                <input type="range"  class ="input" name="num_of_bedrooms" id="num_of_bedrooms" min="1" max="6">
            </form>
        </div>
    </div>
    
  </div>
  <div class="container" id="info">
    <morty class="row" id="iframe"> 

    </morty>
</div>
  
<!-- <div id="map"></div> -->
<br>
<!-- <div id="zoopla_search"><div class="zoopla_header">
  <span><a href="https://www.zoopla.co.uk/" rel="nofollow">Property search</a></span>
</div>
<script type="text/javascript" src="https://www.zoopla.co.uk/widgets/scripts/partner_widgets/search.js?type_rent=1&type_sale=1&type_values=1&type_prices=1"></script>
<div class="zoopla_powered">
  <span>Powered by Zoopla.co.uk</span>
</div>
</div> -->
<script>
  $(document).ready(function(){
    var budget_label =$("#budget_label").append("<span><b>"+$("#budget").val()+"</b></span>");
    var mile_label =$("#mile_label").append("<span><b>"+$("#mile").val()+"</b></span>");
    var bedroom_label = $("#bedroom_label").append("<span><b>"+$("#num_of_bedrooms").val()+"</b></span>");
    var budget_value = $("#budget_label span b");
    var mile_value = $("#mile_label span b");
    var bedroom_value = $("#bedroom_label span b");
    $("#budget").click(function () { 
        var budget= $(this).val();
        budget_value.text(budget);
        console.log(budget);
    });
    $("#mile").click(function () { 
        var mile = $(this).val();
        mile_value.text(mile);
        console.log(mile);
    });
    $("#num_of_bedrooms").click(function () { 
        var bed_no = $(this).val();
        bedroom_value.text(bed_no);
        console.log(bed_no);
    });
    $("#valuation_type").mouseenter(function () { 
        var valu_type = $("#valuation_type option:selected").text();
        console.log(valu_type);
    });
    $("#landmark").mouseenter(function () { 
        var landmark = $("#landmark option:selected").text();
        console.log(landmark);
    });
    $("#building").mouseenter(function () { 
        var building = $("#building option:selected").text();
        console.log(building);
    });


	// TO MAKE THE MAP APPEAR YOU MUST
	// ADD YOUR ACCESS TOKEN FROM
	// https://account.mapbox.com
  mapboxgl.accessToken =
  "pk.eyJ1IjoienlnZXNhbTE5OTkiLCJhIjoiY2wxZjl0ZHVhMDJ3NjNsbWozNWQyNDh3ZyJ9.-p3xg86y--GtvMDIFhtXnw";
  const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      center: [-2.098302664062488, 57.14246896712912],
      zoom: 12,
      pitch: 60, // pitch in degrees
      bearing: -60, // bearing in degrees
  });

  const nav = new mapboxgl.NavigationControl();
  map.addControl(nav);
  map.addControl(new mapboxgl.FullscreenControl());

  map.on('mousemove', (e) => {
    document.getElementById('info').innerHTML =
    // `e.point` is the x, y coordinates of the `mousemove` event
    // relative to the top-left corner of the map.
    JSON.stringify(e.point) +
    '<br />' +
    // `e.lngLat` is the longitude, latitude geographical position of the event.
    JSON.stringify(e.lngLat.wrap());
    });

    //console.log($("#valuation_type option:selected").text())
    //console.log($("#mile").val())
  document.getElementById('map1').addEventListener('click', () => {
  // Fly to a random location by offsetting the point -74.50, 40
  // by up to 5 degrees.
    map.flyTo({
      center: [-2.114864, 57.144156], 
      zoom:15,
      pitch: 60, // pitch in degrees
      bearing: -60, // bearing in degrees
      essential: true 
    });
    //arr.length === 0;
    var mile = $("#mile").val()
    var valu_type = $("#valuation_type option:selected").text()
    var postcode = 'AB10+1XG'
    if(valu_type== 'Rent'){
      var url = 'https://api.propertydata.co.uk/sourced-properties?key=AVMTVRNTJ2&list=high-rental-demand&postcode='+postcode+'&radius='+mile+'&results=60'
    }
    if(valu_type== 'Sale')
    {
      var url = 'https://api.propertydata.co.uk/sourced-properties?key=AVMTVRNTJ2&list=quick-sale-properties&postcode='+postcode+'&radius='+mile+'&results=60'
    }
    if(valu_type== 'Shortlet'){
      var url = 'https://api.propertydata.co.uk/sourced-properties?key=AVMTVRNTJ2&list=short-lease-properties&postcode='+postcode+'&radius='+mile+'&results=60'
    }
    console.log(url)
    fetch(url)
    .then(data => {
      return data.json();
      }).then( house => {
        if(house.properties.length===0)
        {
          alert('No available property')
        }
        else{
          console.log(house.properties)
          map.flyTo({
            center: [house.properties[0]['lng'], house.properties[0]['lat']], 
            zoom:15,
            pitch: 60, // pitch in degrees
            bearing: -60, // bearing in degrees
            essential: true 
          });
          
          map.on('load', () => {
            map.addSource('places', {
            'type': 'geojson',
            'data': {
            'type': 'FeatureCollection',
            'features': [
            {
            'type': 'Feature',
            'properties': {
            'description':
            '<p></p>'+house.properties[0]['address']+'</p><p>'+house.properties[0]['bedrooms']+'</p><p>'+house.properties[0]['type']+'</p><p>'+house.properties[0]['postcode']+'</p><p><strong>'+house.properties[0]['price']+'</strong></p><p> Check out the house <a href="'+house.properties[0]['url']+'"></a></p>'
            },
            'geometry': {
            'type': 'Point',
            'coordinates': [house.properties[0]['lng'], house.properties[0]['lat']]
            }
            }]
        }
            })
        
        map.addLayer({
            'id': 'places',
            'type': 'circle',
            'source': 'places',
            'paint': {
            'circle-color': '#4264fb',
            'circle-radius': 6,
            'circle-stroke-width': 2,
            'circle-stroke-color': '#ffffff'
            }
            });
            // Create a popup, but don't add it to the map yet.
            const popup = new mapboxgl.Popup({
            closeButton: false,
            closeOnClick: false
            });
             
            map.on('mouseenter', 'places', (e) => {
            // Change the cursor style as a UI indicator.
            map.getCanvas().style.cursor = 'pointer';
             
            // Copy coordinates array.
            const coordinates = e.features[0].geometry.coordinates.slice();
            const description = e.features[0].properties.description;
             
            // Ensure that if the map is zoomed out such that multiple
            // copies of the feature are visible, the popup appears
            // over the copy being pointed to.
            while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
            }
        
            // Populate the popup and set its coordinates
            // based on the feature found.
            popup.setLngLat(coordinates).setHTML(description).addTo(map);
            });
             
            map.on('mouseleave', 'places', () => {
            map.getCanvas().style.cursor = '';
            popup.remove();
            });
            });
        }
        
      });
  });

  document.getElementById('map2').addEventListener('click', () => {
    // Fly to Perth.
      map.flyTo({
        center: [-2.121487, 57.137871], 
        zoom:15,
        pitch: 60, // pitch in degrees
        bearing: -60, // bearing in degrees
        essential: true 
      });
    });
    document.getElementById('map3').addEventListener('click', () => {
      // Fly to Glasgow.
        map.flyTo({
        center: [-2.127206, 57.124274], 
        zoom:15,
        pitch: 60, // pitch in degrees
        bearing: -60, // bearing in degrees
        essential: true 
        });
      });
      document.getElementById('map4').addEventListener('click', () => {
        // Fly to Edinburgh.
          map.flyTo({
          center: [-2.093295, 57.142701], 
          zoom:13,
          pitch: 60, // pitch in degrees
          bearing: -60, // bearing in degrees
          essential: true 
          });
          
        });
        document.getElementById('map5').addEventListener('click', () => {
          // Fly to Falkland.
            map.flyTo({
            center: [-2.112455, 57.137468],
            zoom:13,
            pitch: 60, // pitch in degrees
            bearing: -60, // bearing in degrees
            essential: true 
            });
            
          });
          document.getElementById('map6').addEventListener('click', () => {
            // Fly to North Lanarkshire.
              map.flyTo({
              center: [-2.072115, 57.135968], 
              zoom:13,
              pitch: 60, // pitch in degrees
              bearing: -60, // bearing in degrees
              essential: true 
              });

              // Create a default Marker and add it to the map.
              const marker1 = new mapboxgl.Marker()
              .setLngLat([-2.072115, 57.135968])
              .addTo(map);
              
              // Create a default Marker, colored black, rotated 45 degrees.
              const marker2 = new mapboxgl.Marker({ color: 'black', rotation: 45 })
              .setLngLat([-3.9461558, 55.8830507])
              .addTo(map);
              
            });
          });
           
</script>
 
</body>
</html>

